function usuarioCtrl(t,o,n,a,e,r){t.prestacionMP={title:"",cant:1,prec:1},t.noticias="",t.crearModalEnRunTime=function(){var t=$("<ons-modal var=modal><ons-icon icon='ion-load-c' spin='true'></ons-icon><br><br>Aguarde...</ons-modal>");t.appendTo($("body")),ons.compile(t[0])},t.initPoint=function(){if(t.existeAutorizacionMP()){t.crearModalEnRunTime(),t.modal.show();var e=t.verificarTTLAuth();"OK"===e?o.initPointMP(t.prestacionMP.title,t.prestacionMP.cant,t.prestacionMP.prec,n.auth.access_token).then(function(o){var n=o.respuesta;"OK"===n?(t.modal.hide(),a.initPoint=o.contenido.initPoint,a.title=t.prestacionMP.title,a.cant=t.prestacionMP.cant,a.prec=t.prestacionMP.prec,t.app.navigator.pushPage("confirmar.html")):(t.modal.hide(),t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">'+o.contenido+"</strong>"}))})["catch"](function(o,n){t.modal.hide();var a="No autorizado.";switch(n){case 401:a="No autorizado."}t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">Operación denegada: '+a+"</strong>"})}):(t.modal.hide(),t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">'+e+"</strong>"}))}else t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">Para poder operar primero debes obtener tu autorización de MercadoPago</strong>',callback:function(){t.app.navigator.pushPage("autorizar.html")}})},t.abrirInitiPoint=function(){e.open(a.initPoint,"_blank","location=no,clearsessioncache=yes,clearcache=yes")},t.verificarTTLAuth=function(){n.auth=r.auth;var a=n.auth.expires_in,e=Date.now(),i=r.authDate,c=e-i;return c>a?void o.refreshAuth(n.auth.refresh_token).then(function(o){var a=o.respuesta;return"OK"===a?(n.auth=angular.fromJson(o.contenido),t.guardarAutorizacionMP(),"OK"):o.contenido})["catch"](function(t,o){var n="No autorizado.";switch(o){case 401:n="No autorizado."}return n}):"OK"},t.getCobroFactory=function(){return a},t.getUsuarioFactory=function(){return n},t.getTituloMenu=function(){return n.tituloMenu},t.formatDate=function(t){var o=new Date(t);return o},t.abrirMp=function(){t.app.navigator.pushPage("autorizar.html")},t.guardarAutorizacionMP=function(){r.$reset(),r.auth=n.auth,r.authDate=Date.now()},t.borrarAutorizacionMP=function(){r.$reset(),n.auth=""},t.existeAutorizacionMP=function(){return"undefined"==typeof r.auth?!1:""!==r.auth},t.loadIframeMP=function(){if(!t.existeAutorizacionMP()){var a=e.addEventListener?"addEventListener":"attachEvent",r=e[a],i="attachEvent"===a?"onmessage":"message";r(i,function(a){if("OK"===a.data.respuesta){var e=angular.fromJson(a.data.contenido);n.auth=e,o.refreshAuth(n.auth.refresh_token).then(function(o){var a=o.respuesta;"OK"===a?(n.auth=angular.fromJson(o.contenido),t.guardarAutorizacionMP()):t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">'+o.contenido+"</strong>"})})["catch"](function(o,n){var a="No autorizado.";switch(n){case 401:a="No autorizado."}t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">Operación denegada: '+a+"</strong>"})})}},!1)}}}Onsen.controller("usuarioCtrl",["$scope","usuarioService","usuarioFactory","cobroFactory","$window","$localStorage","$document",function(t,o,n,a,e,r,i){ons.ready(function(){n.clientIdMp=r.clientIdMp,n.clientSecretMp=r.clientSecretMp}),usuarioCtrl(t,o,n,a,e,r,i)}]);