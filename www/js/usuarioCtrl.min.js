function usuarioCtrl(t,o,n,a,e,r,i){t.prestacionMP={title:"",cant:1,prec:1},t.noticias="",t.crearModalEnRunTime=function(){var t=$("<ons-modal var=modal><ons-icon icon='ion-load-c' spin='true'></ons-icon><br><br>Aguarde...</ons-modal>");t.appendTo($("body")),ons.compile(t[0])},t.initPoint=function(){if(t.existeAutorizacionMP()){t.crearModalEnRunTime(),t.modal.show();var n=t.verificarTTLAuth();"OK"===n?o.initPointMP(t.prestacionMP.title,t.prestacionMP.cant,t.prestacionMP.prec,a.auth.access_token).then(function(o){var n=o.respuesta;"OK"===n?(t.modal.hide(),e.initPoint=o.contenido.initPoint,e.title=t.prestacionMP.title,e.cant=t.prestacionMP.cant,e.prec=t.prestacionMP.prec,t.app.navigator.pushPage("confirmar.html")):(t.modal.hide(),t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">'+o.contenido+"</strong>"}))})["catch"](function(o,n){t.modal.hide();var a="No autorizado.";switch(n){case 401:a="No autorizado."}t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">Operación denegada: '+a+"</strong>"})}):(t.modal.hide(),t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">'+n+"</strong>"}))}else t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">Para poder operar primero debes obtener tu autorización de MercadoPago</strong>'})},t.abrirInitiPoint=function(){r.open(e.initPoint,"_blank")},t.verificarTTLAuth=function(){a.auth=i.auth;var n=a.auth.expires_in,e=Date.now(),r=i.authDate,c=e-r;return c>n?void o.refreshAuth(a.auth.refresh_token).then(function(o){var n=o.respuesta;return"OK"===n?(a.auth=angular.fromJson(o.contenido),t.guardarAutorizacionMP(),"OK"):o.contenido})["catch"](function(t,o){var n="No autorizado.";switch(o){case 401:n="No autorizado."}return n}):"OK"},t.getCobroFactory=function(){return e},t.getUsuarioFactory=function(){return a},t.getTituloMenu=function(){return a.tituloMenu},t.formatDate=function(t){var o=new Date(t);return o},t.abrirMp=function(){t.app.navigator.pushPage("autorizar.html")},t.guardarAutorizacionMP=function(){i.$reset(),i.auth=a.auth,i.authDate=Date.now()},t.borrarAutorizacionMP=function(){i.$reset(),a.auth=""},t.existeAutorizacionMP=function(){return"undefined"==typeof i.auth?!1:""!==i.auth},t.loadIframeMP=function(){var n=r.addEventListener?"addEventListener":"attachEvent",e=r[n],i="attachEvent"===n?"onmessage":"message";e(i,function(n){if("OK"===n.data.respuesta){var e=angular.fromJson(n.data.contenido);a.auth=e,o.refreshAuth(a.auth.refresh_token).then(function(o){var n=o.respuesta;"OK"===n?(a.auth=angular.fromJson(o.contenido),t.guardarAutorizacionMP()):(t.modal.hide(),t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">'+o.contenido+"</strong>"}))})["catch"](function(o,n){var a="No autorizado.";switch(n){case 401:a="No autorizado."}t.ons.notification.alert({title:"Info",messageHTML:'<strong style="color: #ff3333">Operación denegada: '+a+"</strong>"})})}},!1)}}Onsen.controller("usuarioCtrl",["$scope","usuarioService","authService","usuarioFactory","cobroFactory","$window","$localStorage","$interval",function(t,o,n,a,e,r,i,c){ons.ready(function(){a.clientIdMp=i.clientIdMp,a.clientSecretMp=i.clientSecretMp}),usuarioCtrl(t,o,n,a,e,r,i,c)}]);